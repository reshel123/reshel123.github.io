<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æ™ºèƒ½åŠ©æ‰‹ä¸èµ„æºä¸­å¿ƒï¼šAI èŠå¤©ã€è½¯ä»¶ä¸‹è½½ä¸ä¸°å¯Œçš„äº¤äº’ä½“éªŒï¼ŒåŒ…å«éŸ³ä¹ã€å¤©æ°”ä¸å¤šè¯­è¨€æ”¯æŒã€‚">
    <meta name="theme-color" content="#667eea">
    <link rel="canonical" href="https://289872.xyz/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="é»„é‡‘æ ‘ç«‹èª“ - æ™ºèƒ½åŠ©æ‰‹ä¸èµ„æºä¸­å¿ƒ">
    <meta property="og:description" content="AI æ™ºèƒ½èŠå¤©ä¸èµ„æºä¸‹è½½ï¼Œä¸€ç«™å¼ä¾¿æ·ä½“éªŒã€‚">
    <meta property="og:image" content="/assets/img/erd.jpg">
    <meta property="og:url" content="https://289872.xyz/">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="preconnect" href="https://music.163.com" crossorigin>
    <link rel="preconnect" href="https://nu4wctjgeg.re.qweatherapi.com" crossorigin>
    <link rel="preconnect" href="https://api.bigdatacloud.net" crossorigin>
    <link rel="preconnect" href="https://nominatim.openstreetmap.org" crossorigin>
    <link rel="preload" as="image" href="/assets/img/erd.webp">
    <link rel="prefetch" href="/ai">
    <link rel="prefetch" href="/downloads">
    <title>é»„é‡‘æ ‘ç«‹èª“</title>
    <link rel="icon" href="/assets/img/icon.jpg" type="image/jpeg">
    <link rel="shortcut icon" href="/assets/img/icon.jpg" type="image/jpeg">
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #ffffff;
            position: relative;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
            transition: background-image 0.5s ease;
        }
        
        body.loaded {
            background-image: url('/assets/img/erd.jpg');
        }
        
        /* èƒŒæ™¯é®ç½© */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: -1;
        }
        
        /* ç°ä»£åŒ–åŠ è½½åŠ¨ç”» */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .loading-screen.hidden {
            opacity: 0;
            transform: scale(1.1);
            pointer-events: none;
        }
        
        .loading-content {
            text-align: center;
            position: relative;
            z-index: 2;
        }
        
        .loading-logo {
            font-size: 4.5rem;
            margin-top: 3rem;
            margin-bottom: 2.5rem;
            animation: logoSparkle 3s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(255, 215, 0, 0.4));
            background: linear-gradient(135deg, #FFD700, #FFA500, #FF69B4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        @keyframes logoSparkle {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg) scale(1);
                filter: drop-shadow(0 10px 20px rgba(255, 215, 0, 0.4));
            }
            25% { 
                transform: translateY(-15px) rotate(90deg) scale(1.1);
                filter: drop-shadow(0 15px 25px rgba(255, 215, 0, 0.6));
            }
            50% { 
                transform: translateY(-20px) rotate(180deg) scale(1.2);
                filter: drop-shadow(0 20px 30px rgba(255, 215, 0, 0.8));
            }
            75% { 
                transform: translateY(-15px) rotate(270deg) scale(1.1);
                filter: drop-shadow(0 15px 25px rgba(255, 215, 0, 0.6));
            }
        }
        
        .loading-title {
            color: white;
            font-size: 3.2rem;
            font-weight: 800;
            margin-bottom: 2rem;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            letter-spacing: 3px;
            animation: titleGlow 2s ease-in-out infinite alternate;
            background: linear-gradient(135deg, #ffffff, #f0f0f0, #e0e0e0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        @keyframes titleGlow {
            0% { text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); }
            100% { text-shadow: 0 4px 20px rgba(255, 255, 255, 0.5); }
        }
        
        .loading-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            margin-bottom: 3rem;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .loading-spinner-container {
            position: relative;
            margin: 1.5rem auto;
            width: 120px;
            height: 120px;
        }
        
        .loading-spinner {
            width: 100%;
            height: 100%;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid #ffffff;
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }
        
        .loading-spinner::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-top: 2px solid rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: spin 2s linear infinite reverse;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-progress {
            width: 300px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin: 2rem auto;
            overflow: hidden;
            position: relative;
        }
        
        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ffffff, #f0f0f0);
            border-radius: 3px;
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .loading-countdown {
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 1rem 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            animation: countdownPulse 1s ease-in-out infinite alternate;
        }
        
        @keyframes countdownPulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }
        
        .loading-text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            margin: 1rem 0;
            font-weight: 400;
            letter-spacing: 0.5px;
        }
        
        .loading-music {
            margin-top: 3rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
        }
        
        .loading-music:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }
        
        .loading-music h4 {
            color: white;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            margin-top: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .loading-music-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .loading-music-btn {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.3));
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            min-width: 100px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .loading-music-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        .loading-music-info {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin-top: 1rem;
            text-align: center;
            font-weight: 500;
        }
        
        .loading-music-counter {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
            margin-top: 0.5rem;
            text-align: center;
        }
        
        .loading-pc-tip {
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
        }
        
        .loading-pc-tip:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .loading-pc-tip p {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1rem;
            text-align: center;
            font-weight: 500;
            margin: 0;
            line-height: 1.5;
        }
        
        /* æµ®åŠ¨è£…é¥°å…ƒç´  */
        .loading-decoration {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .floating-orb {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 6s ease-in-out infinite;
        }
        
        .floating-orb:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .floating-orb:nth-child(2) {
            width: 60px;
            height: 60px;
            top: 20%;
            right: 15%;
            animation-delay: 2s;
        }
        
        .floating-orb:nth-child(3) {
            width: 100px;
            height: 100px;
            bottom: 20%;
            left: 20%;
            animation-delay: 4s;
        }
        
        .floating-orb:nth-child(4) {
            width: 40px;
            height: 40px;
            bottom: 10%;
            right: 10%;
            animation-delay: 1s;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        /* æµ®åŠ¨ç²’å­æ•ˆæœ */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
        }
        
        .container {
            position: relative;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            z-index: 1;
            padding: 20px;
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 80px 30px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: slideDown 1s ease-out;
            min-height: 200px;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            position: relative;
        }
        
        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 12px;
            z-index: 10;
        }
        
        /* å¤©æ°”æ¨¡å—æ ·å¼ */
        .weather-widget {
            position: absolute;
            top: -70px;
            left: 20px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 12px 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            min-width: 120px;
            max-width: 140px;
            text-align: center;
            animation: fadeInUp 1s ease-out 0.8s both;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .weather-widget:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }
        
        /* éŸ³ä¹æ’­æ”¾å™¨æ ·å¼ */
        .music-player {
            position: absolute;
            top: 10px;
            right: 80px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            min-width: 220px;
            max-width: 280px;
            text-align: center;
            animation: fadeInUp 1s ease-out 1s both;
            transition: all 0.3s ease;
        }
        
        .music-player:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.35);
            box-shadow: 0 16px 50px rgba(0, 0, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .music-player h3 {
            color: #ffffff;
            font-size: 15px;
            margin: 0 0 15px 0;
            font-weight: 600;
            text-shadow: 0 2px 12px rgba(0, 0, 0, 0.4);
            letter-spacing: 0.5px;
        }
        
        .music-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .play-btn {
            background: rgba(255, 255, 255, 0.18);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.35);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .play-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.08);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .play-btn.playing {
            background: rgba(76, 175, 80, 0.25);
            border-color: rgba(76, 175, 80, 0.6);
            animation: pulse 2s infinite;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.2);
        }
        
        .switch-btn {
            background: rgba(255, 255, 255, 0.18);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.35);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .switch-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.08) rotate(180deg);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* é¼ æ ‡è·Ÿéšç‰¹æ•ˆ */
        .cursor-follower {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.9) 0%, rgba(103, 126, 234, 0.7) 50%, rgba(255, 255, 255, 0.3) 100%);
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(103, 126, 234, 0.6), 0 0 25px rgba(255, 255, 255, 0.4);
            transform: translate(-50%, -50%);
            transition: none;
            mix-blend-mode: screen;
        }
        
        .cursor-follower.clicked {
            background: radial-gradient(circle, rgba(255, 215, 0, 0.95) 0%, rgba(255, 193, 7, 0.8) 50%, rgba(255, 215, 0, 0.4) 100%);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7), 0 0 35px rgba(255, 193, 7, 0.5);
            transform: translate(-50%, -50%) scale(1.5);
            animation: clickEffect 0.3s ease-out;
        }
        
        @keyframes clickEffect {
            0% {
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                transform: translate(-50%, -50%) scale(2);
            }
            100% {
                transform: translate(-50%, -50%) scale(1.5);
            }
        }
        
        .music-info {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.85);
            margin-top: 8px;
            font-weight: 500;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            line-height: 1.4;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .music-counter {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 4px;
            font-weight: 400;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .music-progress {
            width: 100%;
            height: 5px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 3px;
            margin-top: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .music-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.9));
            border-radius: 3px;
            width: 0%;
            transition: width 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }
        
        .weather-widget::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, transparent 50%, rgba(255, 255, 255, 0.03) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .weather-widget:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .weather-widget:hover::before {
            opacity: 1;
        }
        
        .weather-location {
            font-size: 0.65em;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 6px;
            font-weight: 500;
            letter-spacing: 0.2px;
        }
        
        .weather-temp {
            font-size: 1.3em;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 4px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .weather-desc {
            font-size: 0.7em;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .weather-details {
            display: flex;
            justify-content: space-around;
            font-size: 0.6em;
            color: rgba(255, 255, 255, 0.6);
            gap: 8px;
        }
        
        .weather-detail {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1px;
        }
        
        .weather-detail span:first-child {
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.55em;
            text-transform: uppercase;
            letter-spacing: 0.2px;
        }
        
        .weather-detail span:last-child {
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .weather-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 30px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.7em;
            gap: 8px;
        }
        
        .weather-error {
            color: rgba(255, 107, 107, 0.8);
            font-size: 0.7em;
            padding: 6px;
        }
        
        .weather-city {
            font-size: 0.6em;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 4px;
            font-weight: 400;
            opacity: 0.9;
        }
        
        .main-title {
            font-size: 2.5em;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            text-align: center;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            z-index: 5;
            margin: 0;
        }
        
        .language-switch {
            position: absolute;
            top: -50px;
            left: 40%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 15;
        }
        
        .language-switch:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(-50%) translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .header-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .main-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 20px 40px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .main-button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .ai-chat-button {
            background: rgba(255, 107, 107, 0.2);
            border-color: rgba(255, 107, 107, 0.5);
        }
        
        .ai-chat-button:hover {
            background: rgba(255, 107, 107, 0.3);
        }
        
        .software-library-button {
            background: rgba(78, 205, 196, 0.2);
            border-color: rgba(78, 205, 196, 0.5);
        }
        
        .software-library-button:hover {
            background: rgba(78, 205, 196, 0.3);
        }
        
        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 40px;
        }
        
        .welcome-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 50px 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: slideUp 1s ease-out 0.3s both;
            margin-bottom: 40px;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .welcome-message {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .welcome-message h2 {
            font-size: 2.8em;
            font-weight: 700;
            margin-bottom: 25px;
            color: #ffffff;
            text-shadow: 0 2px 15px rgba(0, 0, 0, 0.4);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-message p {
            font-size: 1.3em;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            margin-bottom: 18px;
            font-weight: 500;
            text-shadow: 0 1px 8px rgba(0, 0, 0, 0.3);
        }
        
        .loading-tip {
            font-size: 1em;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
            margin-bottom: 20px;
            font-weight: 400;
            text-shadow: 0 1px 6px rgba(0, 0, 0, 0.3);
            font-style: italic;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 40px;
            margin-top: 0;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            cursor: pointer;
        }
        
        .feature-card::after {
            content: 'ç‚¹å‡»è¿›å…¥';
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .feature-card:hover::after {
            opacity: 1;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .feature-card h3 {
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #ffffff;
        }
        
        .feature-card p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            font-size: 1em;
        }
        
        /* é¡µè„šæ ·å¼ */
        footer {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            border-radius: 20px;
            margin-top: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideUp 1s ease-out 0.6s both;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header-top {
                flex-direction: column;
                gap: 20px;
                align-items: center;
            }
            
            .header-right {
                position: static;
                order: -1;
                margin-bottom: 15px;
            }
            
            .main-title {
                font-size: 2em;
                text-align: center;
                order: 1;
                position: static;
                transform: none;
                width: auto;
            }
            
            .weather-widget {
                position: static;
                margin-bottom: 15px;
                order: -2;
                top: auto;
                left: auto;
                min-width: 100px;
                max-width: 120px;
                padding: 10px 8px;
            }
            
            .language-switch {
                position: static;
                order: -1;
                margin-bottom: 10px;
                top: auto;
                right: auto;
            }
            
            .weather-temp {
                font-size: 1.1em;
            }
            
            .weather-details {
                flex-direction: column;
                gap: 4px;
            }
            
            .weather-city {
                font-size: 0.55em;
                margin-top: 3px;
            }
            
            .header-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .main-button {
                width: 100%;
                padding: 18px 30px;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .welcome-section {
                padding: 30px 20px;
            }
            
            .welcome-message h2 {
                font-size: 2em;
            }
            
            .welcome-message p {
                font-size: 1.1em;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            
            .feature-card {
                padding: 30px 25px;
                min-height: 180px;
            }

            .music-player {
                min-width: 180px;
                max-width: 220px;
            }
            
            /* ç§»åŠ¨ç«¯åŠ è½½é¡µæ ·å¼ */
            .loading-logo {
                font-size: 3.5rem;
                margin-top: 2rem;
                margin-bottom: 2rem;
            }
            
            .loading-title {
                font-size: 2.5rem;
                margin-bottom: 1.5rem;
                letter-spacing: 2px;
            }
            
            .loading-spinner-container {
                margin: 1rem auto;
                width: 100px;
                height: 100px;
            }
            
            .loading-progress {
                width: 250px;
                margin: 1.5rem auto;
            }
            
            .loading-countdown {
                font-size: 1.2rem;
            }
            
            .loading-text {
                font-size: 0.9rem;
            }
            
            .loading-music {
                max-width: 300px;
                padding: 1.5rem;
                margin-top: 2rem;
            }
            
            .loading-pc-tip {
                max-width: 300px;
                padding: 1rem;
                margin: 1.5rem auto;
            }
            
            .music-player {
                top: 5px;
                right: 60px;
                padding: 12px;
            }

            .play-btn, .switch-btn {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
            
            .music-info {
                font-size: 11px;
            }
            
            .music-counter {
                font-size: 10px;
            }
            
            .music-progress {
                height: 4px;
                margin-top: 8px;
            }
            
            /* é™ä½ç§»åŠ¨ç«¯ç²’å­æ•°é‡ */
            .particles { opacity: 0.7; }
            
            /* ç§»åŠ¨ç«¯åŠ è½½é¡µä¼˜åŒ– */
            .loading-title {
                font-size: 2rem;
                letter-spacing: 1px;
            }
            
            .loading-subtitle {
                font-size: 1rem;
                margin-bottom: 2rem;
            }
            
            .loading-logo {
                font-size: 3rem;
                margin-bottom: 1.5rem;
            }
            
            .loading-spinner-container {
                width: 80px;
                height: 80px;
                margin: 1.5rem auto;
            }
            
            .loading-progress {
                width: 250px;
                height: 5px;
            }
            
            .loading-music {
                margin-top: 2rem;
                padding: 1.5rem;
                max-width: 300px;
            }
            
            .loading-music h4 {
                font-size: 1rem;
            }
            
            .loading-music-btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.8rem;
                min-width: 80px;
            }
            
            .loading-pc-tip {
                margin: 1.5rem 0;
                padding: 1rem;
                max-width: 300px;
            }
            
            .loading-pc-tip p {
                font-size: 0.9rem;
            }
            
            .floating-orb:nth-child(1) {
                width: 60px;
                height: 60px;
            }
            
            .floating-orb:nth-child(2) {
                width: 40px;
                height: 40px;
            }
            
            .floating-orb:nth-child(3) {
                width: 70px;
                height: 70px;
            }
            
            .floating-orb:nth-child(4) {
                width: 30px;
                height: 30px;
            }
        }
        
        @media (max-width: 480px) {
            .music-player {
                position: static;
                margin: 0 auto 15px auto;
                width: 100%;
                max-width: 280px;
                padding: 15px;
            }
            
            .music-player h3 {
                font-size: 14px;
                margin-bottom: 12px;
            }
            
            .play-btn, .switch-btn {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }
            
            .music-info {
                font-size: 11px;
            }
            
            .music-counter {
                font-size: 9px;
            }
            
            .music-controls {
                gap: 10px;
            }
            
            /* è¶…å°å±å¹•åŠ è½½é¡µä¼˜åŒ– */
            .loading-title {
                font-size: 1.8rem;
                letter-spacing: 0.5px;
            }
            
            .loading-subtitle {
                font-size: 0.9rem;
                margin-bottom: 1.5rem;
            }
            
            .loading-logo {
                font-size: 2.5rem;
                margin-top: 1.5rem;
                margin-bottom: 1rem;
            }
            
            .loading-spinner-container {
                width: 60px;
                height: 60px;
                margin: 1rem auto;
            }
            
            .loading-progress {
                width: 200px;
                height: 4px;
            }
            
            .loading-music {
                margin-top: 1.5rem;
                padding: 1rem;
                max-width: 280px;
            }
            
            .loading-music h4 {
                font-size: 0.9rem;
            }
            
            .loading-music-btn {
                padding: 0.5rem 1rem;
                font-size: 0.7rem;
                min-width: 70px;
            }
            
            .loading-pc-tip {
                margin: 1rem 0;
                padding: 0.8rem;
                max-width: 280px;
            }
            
            .loading-pc-tip p {
                font-size: 0.8rem;
            }
            
            .floating-orb:nth-child(1) {
                width: 40px;
                height: 40px;
            }
            
            .floating-orb:nth-child(2) {
                width: 30px;
                height: 30px;
            }
            
            .floating-orb:nth-child(3) {
                width: 50px;
                height: 50px;
            }
            
            .floating-orb:nth-child(4) {
                width: 20px;
                height: 20px;
            }
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            flex-shrink: 0;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- ç°ä»£åŒ–åŠ è½½å±å¹• -->
    <div class="loading-screen" id="loadingScreen">
        <!-- æµ®åŠ¨è£…é¥°å…ƒç´  -->
        <div class="loading-decoration">
            <div class="floating-orb"></div>
            <div class="floating-orb"></div>
            <div class="floating-orb"></div>
            <div class="floating-orb"></div>
        </div>
        
        <div class="loading-content">
            <div class="loading-logo">âœ¨</div>
            <div class="loading-title">ä½ å¥½ï¼</div>
            
            <div class="loading-spinner-container">
                <div class="loading-spinner"></div>
            </div>
            
            <div class="loading-progress">
                <div class="loading-progress-bar" id="loadingProgressBar"></div>
            </div>
            
            <div class="loading-countdown" id="loadingCountdown">æ­£åœ¨å‡†å¤‡ä½“éªŒ...</div>
            <div class="loading-text">æ­£åœ¨åŠ è½½ç²¾å½©å†…å®¹ï¼Œè¯·ç¨å€™...</div>
            
            <!-- PCç«¯è®¿é—®æç¤º -->
            <div class="loading-pc-tip">
                <p>ğŸ’» å»ºè®®ä½¿ç”¨PCç«¯è®¿é—®ï¼Œç§»åŠ¨ç«¯åŠ è½½è¾ƒæ…¢</p>
            </div>
            
            <!-- åŠ è½½æ—¶éŸ³ä¹æ’­æ”¾å™¨ -->
            <div class="loading-music">
                <h4>ğŸµ ç­‰å¾…æ—¶å¬å¬éŸ³ä¹</h4>
                <div class="loading-music-controls">
                    <button class="loading-music-btn" id="loadingPlayBtn">â–¶ï¸ æ’­æ”¾</button>
                    <button class="loading-music-btn" id="loadingPauseBtn" style="display: none;">â¸ï¸ æš‚åœ</button>
                    <button class="loading-music-btn" id="loadingSwitchBtn" title="åˆ‡æ¢æ­Œæ›²">ğŸ”„</button>
                </div>
                <div class="loading-music-info" id="loadingMusicInfo">Landslide - Oh Wonder</div>
                <div class="loading-music-counter" id="loadingMusicCounter">1/3</div>
            </div>
        </div>
    </div>
    
    <!-- æµ®åŠ¨ç²’å­ -->
    <div class="particles" id="particles"></div>
    
    <!-- é¼ æ ‡æ‹–å°¾å®¹å™¨ -->
            <div class="cursor-follower" id="cursorFollower"></div>
    
    <div class="container">
        <header>
            <div class="header-top">
                <h1 id="mainTitle" class="main-title">æ¬¢è¿ï¼</h1>
                <div class="weather-widget" id="weatherWidget" onclick="refreshLocationAndWeather()" title="ç‚¹å‡»åˆ·æ–°ä½ç½®å’Œå¤©æ°”">
                    <div class="weather-loading">
                        <div class="spinner"></div>
                        <span>åŠ è½½å¤©æ°”ä¸­...</span>
                    </div>
                </div>
                <button id="languageSwitch" class="language-switch">ğŸŒ ä¸­æ–‡</button>
            </div>
            
            <!-- éŸ³ä¹æ’­æ”¾å™¨ -->
            <div class="music-player" id="musicPlayer">
                <h3>ğŸµ èƒŒæ™¯éŸ³ä¹</h3>
                <div class="music-controls">
                    <button class="play-btn" id="playBtn">â–¶ï¸</button>
                    <button class="switch-btn" id="switchBtn" title="éšæœºåˆ‡æ¢æ­Œæ›²">ğŸ”„</button>
                </div>
                <div class="music-info" id="musicInfo">Story of us - July</div>
                <div class="music-counter" id="musicCounter">1/11</div>
                <div class="music-progress">
                    <div class="music-progress-bar" id="progressBar"></div>
                </div>
            </div>
        </header>
        
        <main>
            <div class="welcome-section">
                <div class="welcome-message">
                    <h2 id="welcomeTitle">æ™ºèƒ½åŠ©æ‰‹ & èµ„æºä¸­å¿ƒ</h2>
                    <div class="loading-tip" id="loadingTip">é¦–æ¬¡ä½¿ç”¨åŠ è½½æ—¶é—´é•¿ï¼Œè¯·è€å¿ƒç­‰å¾…</div>
                    <p id="welcomeText1">è¿™é‡Œæœ‰AIæ™ºèƒ½èŠå¤©å’Œè½¯ä»¶ä¸‹è½½ä¸¤ä¸ªå®ç”¨åŠŸèƒ½</p>
                    <p id="welcomeText2">ç‚¹å‡»ä¸‹æ–¹å¡ç‰‡ï¼Œå¼€å§‹ä½¿ç”¨å§</p>
                </div>
                
                <div class="features-grid">
                    <div class="feature-card" id="aiFeatureCard">
                        <h3>ğŸ¤– AIæ™ºèƒ½èŠå¤©</h3>
                        <p id="aiFeatureText">åŸºäºå¤šç§AIæ¨¡å‹çš„æ™ºèƒ½åŠ©æ‰‹ï¼Œæ”¯æŒGPT-4oã€DeepSeekç­‰ä¸»æµæ¨¡å‹ï¼Œæä¾›å‡†ç¡®ã€æœ‰å¸®åŠ©çš„å›ç­”ï¼Œè®©æ‚¨çš„å¯¹è¯æ›´åŠ æ™ºèƒ½å’Œé«˜æ•ˆ</p>
                    </div>
                    <div class="feature-card" id="softwareFeatureCard">
                        <h3>ğŸ“¦ èµ„æºä¸‹è½½ä¸­å¿ƒ</h3>
                        <p id="softwareFeatureText">æä¾›å„ç§è½¯ä»¶ã€æ¸¸æˆã€å·¥å…·å’Œèµ„æºçš„ä¸‹è½½æœåŠ¡ï¼ŒåŒ…æ‹¬Windowsåº”ç”¨ã€å®‰å“åº”ç”¨å’Œåª’ä½“æ–‡ä»¶ï¼Œæ»¡è¶³æ‚¨çš„å„ç§éœ€æ±‚</p>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <p id="footerText">Â© 2025 | ä½œè€…ï¼šé»„é‡‘æ ‘</p>
        </footer>
    </div>
    
    <script>
        // è¯­è¨€é…ç½®
        const languages = {
            zh: {
                mainTitle: 'æ¬¢è¿ï¼',
                welcomeTitle: 'æ™ºèƒ½åŠ©æ‰‹ & èµ„æºä¸­å¿ƒ',
                loadingTip: 'é¦–æ¬¡ä½¿ç”¨åŠ è½½æ—¶é—´é•¿ï¼Œè¯·è€å¿ƒç­‰å¾…',
                welcomeText1: 'è¿™é‡Œæœ‰AIæ™ºèƒ½èŠå¤©å’Œè½¯ä»¶ä¸‹è½½ä¸¤ä¸ªå®ç”¨åŠŸèƒ½',
                welcomeText2: 'ç‚¹å‡»ä¸‹æ–¹å¡ç‰‡ï¼Œå¼€å§‹ä½¿ç”¨å§',
                aiFeatureText: 'åŸºäºå¤šç§AIæ¨¡å‹çš„æ™ºèƒ½åŠ©æ‰‹ï¼Œæ”¯æŒGPT-4oã€DeepSeekç­‰ä¸»æµæ¨¡å‹ï¼Œæä¾›å‡†ç¡®ã€æœ‰å¸®åŠ©çš„å›ç­”ï¼Œè®©æ‚¨çš„å¯¹è¯æ›´åŠ æ™ºèƒ½å’Œé«˜æ•ˆ',
                softwareFeatureText: 'æä¾›å„ç§è½¯ä»¶ã€æ¸¸æˆã€å·¥å…·å’Œèµ„æºçš„ä¸‹è½½æœåŠ¡ï¼ŒåŒ…æ‹¬Windowsåº”ç”¨ã€å®‰å“åº”ç”¨å’Œåª’ä½“æ–‡ä»¶ï¼Œæ»¡è¶³æ‚¨çš„å„ç§éœ€æ±‚',
                footerText: 'Â© 2025 | ä½œè€…ï¼šé»„é‡‘æ ‘',
                languageButton: 'ğŸŒ ä¸­æ–‡',
            },
            en: {
                mainTitle: 'Welcome!',
                welcomeTitle: 'Smart Assistant & Resource Center',
                loadingTip: 'First use takes a long time to load, please wait patiently',
                welcomeText1: 'Here are two practical features: AI intelligent chat and software download',
                welcomeText2: 'Click the cards below to get started',
                aiFeatureText: 'Intelligent assistant based on multiple AI models, supporting GPT-4o, DeepSeek and other mainstream models, providing accurate and helpful answers to make your conversations smarter and more efficient',
                softwareFeatureText: 'Provide various software, games, tools and resource download services, including Windows apps, Android apps and media files to meet your various needs',
                footerText: 'Â© 2025 | Author: Golden Tree',
                languageButton: 'ğŸŒ English'
            }
        };
        
        let currentLanguage = 'zh';
        
        // åˆ›å»ºæµ®åŠ¨ç²’å­
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const isMobile = window.matchMedia && window.matchMedia('(max-width: 768px)').matches;
            const particleCount = isMobile ? 20 : 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particlesContainer.appendChild(particle);
            }
        }
        
        // é¼ æ ‡æ‹–å°¾ç‰¹æ•ˆ
        let mouseX = 0;
        let mouseY = 0;
        let isHovering = false;

        
        function initCursorTrail() {
            const cursorFollower = document.getElementById('cursorFollower');
            
            // ä½¿ç”¨requestAnimationFrameä¼˜åŒ–æ€§èƒ½
            let ticking = false;
            
            function updateCursorPosition(e) {
                cursorFollower.style.left = e.clientX + 'px';
                cursorFollower.style.top = e.clientY + 'px';
                ticking = false;
            }
            
            // ç›‘å¬é¼ æ ‡ç§»åŠ¨
            document.addEventListener('mousemove', function(e) {
                if (!ticking) {
                    requestAnimationFrame(() => updateCursorPosition(e));
                    ticking = true;
                }
            });
            
            // ç›‘å¬ç‚¹å‡»äº‹ä»¶
            document.addEventListener('mousedown', function(e) {
                if (e.target.matches('button, .feature-card, .music-player, .weather-widget, a, .language-switch, *')) {
                    cursorFollower.classList.add('clicked');
                }
            });
            
            document.addEventListener('mouseup', function(e) {
                // å»¶è¿Ÿç§»é™¤ç‚¹å‡»æ•ˆæœ
                setTimeout(() => {
                    cursorFollower.classList.remove('clicked');
                }, 300);
            });
            
            // é¼ æ ‡ç¦»å¼€é¡µé¢æ—¶éšè—è·Ÿéšå™¨
            document.addEventListener('mouseleave', function() {
                cursorFollower.style.opacity = '0';
            });
            
            // é¼ æ ‡è¿›å…¥é¡µé¢æ—¶æ˜¾ç¤ºè·Ÿéšå™¨
            document.addEventListener('mouseenter', function() {
                cursorFollower.style.opacity = '1';
            });
        }
        
        // éŸ³ä¹æ’­æ”¾å™¨åŠŸèƒ½
        let audio = null;
        let isPlaying = false;
        let currentSongIndex = 0;
        let playedSongs = []; // è®°å½•å·²æ’­æ”¾çš„æ­Œæ›²ç´¢å¼•
        let userInteracted = false; // ç”¨æˆ·æ˜¯å¦å·²ä¸é¡µé¢äº¤äº’
        let audioInitialized = false; // éŸ³é¢‘æ˜¯å¦å·²åˆå§‹åŒ–
        
        // æ­Œæ›²åˆ—è¡¨
        const songs = [
            {
                url: 'https://music.163.com/song/media/outer/url?id=399347079.mp3',
                name: 'Story of us - July'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=1372188635.mp3',
                name: 'Daylight - Seredris'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=1805290933.mp3',
                name: 'All Girls Are The Same - Juice WRLD'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=410802679.mp3',
                name: 'Lot To Learn - Luke Christopher'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=512621132.mp3',
                name: 'Breathe - Kenzie'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=1398283847.mp3',
                name: 'æˆ‘åªèƒ½ç¦»å¼€ - é¢œäººä¸­'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=1786869.mp3',
                name: 'So Sick - Ne-Yo'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=227693.mp3',
                name: 'ä¸€ç‚¹ç‚¹å–œæ¬¢ - é‚“ç¦å¦‚ AFÃœ'
            },
            // ä»åŠ è½½é¡µæ·»åŠ çš„æ­Œæ›²
            {
                url: 'https://music.163.com/song/media/outer/url?id=1846511389.mp3',
                name: 'Landslide - Oh Wonder'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=2086154795.mp3',
                name: 'Tek It - Cream Pie'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=1862710424.mp3',
                name: 'Stay - The Kid LAROI/Justin Bieber'
            }
        ];
        
        // åˆ›å»ºéŸ³é¢‘å¯¹è±¡
        function createAudioObject() {
            if (audio) {
                audio.pause();
                audio.removeEventListener('loadedmetadata', handleAudioLoaded);
                audio.removeEventListener('timeupdate', handleTimeUpdate);
                audio.removeEventListener('ended', handleAudioEnded);
                audio.removeEventListener('error', handleAudioError);
            }
            
            audio = new Audio();
            audio.preload = 'none'; // ä¸é¢„åŠ è½½ï¼Œé¿å…è·¨åŸŸé—®é¢˜
            // ç§»é™¤ crossOrigin è®¾ç½®ï¼Œé¿å…CORSé™åˆ¶
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            audio.addEventListener('loadedmetadata', handleAudioLoaded);
            audio.addEventListener('timeupdate', handleTimeUpdate);
            audio.addEventListener('ended', handleAudioEnded);
            audio.addEventListener('error', handleAudioError);
            
            return audio;
        }
        
        // éŸ³é¢‘åŠ è½½å®Œæˆå¤„ç†
        function handleAudioLoaded() {
            console.log('éŸ³é¢‘åŠ è½½å®Œæˆ');
            document.getElementById('musicInfo').textContent = songs[currentSongIndex].name;
            // åˆå§‹åŒ–æ—¶è®°å½•ç¬¬ä¸€é¦–æ­Œåˆ°æ’­æ”¾å†å²
            if (playedSongs.length === 0) {
                playedSongs.push(currentSongIndex);
            }
            document.getElementById('musicCounter').textContent = `${playedSongs.length}/${songs.length}`;
            // é‡ç½®è¿›åº¦æ¡
            document.getElementById('progressBar').style.width = '0%';
        }
        
        // æ—¶é—´æ›´æ–°å¤„ç†
        function handleTimeUpdate() {
            if (audio.duration && !isNaN(audio.duration)) {
                const progress = (audio.currentTime / audio.duration) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
            }
        }
        
        // éŸ³é¢‘æ’­æ”¾ç»“æŸå¤„ç†
        function handleAudioEnded() {
            isPlaying = false;
            document.getElementById('playBtn').textContent = 'â–¶ï¸';
            document.getElementById('playBtn').classList.remove('playing');
            document.getElementById('progressBar').style.width = '0%';
            // è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–
            setTimeout(() => {
                switchSong();
            }, 1000);
        }
        
        // éŸ³é¢‘é”™è¯¯å¤„ç†
        function handleAudioError(e) {
            console.error('éŸ³é¢‘åŠ è½½å¤±è´¥:', e);
            document.getElementById('musicInfo').textContent = 'éŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œç‚¹å‡»åˆ‡æ¢';
            
            // å°è¯•ä½¿ç”¨iframeæ–¹å¼æ’­æ”¾ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
            tryIframePlayback();
            
            // è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–
            setTimeout(() => {
                switchSong();
            }, 2000);
        }
        
        // å°è¯•ä½¿ç”¨iframeæ’­æ”¾ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
        function tryIframePlayback() {
            console.log('å°è¯•iframeæ’­æ”¾æ–¹æ¡ˆ...');
            // è¿™é‡Œå¯ä»¥æ·»åŠ iframeæ’­æ”¾é€»è¾‘
        }
        
        // åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
        function initMusicPlayer() {
            const playBtn = document.getElementById('playBtn');
            const switchBtn = document.getElementById('switchBtn');
            
            // åˆ›å»ºéŸ³é¢‘å¯¹è±¡
            createAudioObject();
            
            // æ’­æ”¾/æš‚åœæŒ‰é’®äº‹ä»¶
            playBtn.addEventListener('click', function() {
                userInteracted = true;
                togglePlay();
            });
            
            // åˆ‡æ¢æ­Œæ›²æŒ‰é’®äº‹ä»¶
            switchBtn.addEventListener('click', function() {
                userInteracted = true;
                switchSong();
            });
            
            // é”®ç›˜å¿«æ·é”®æ”¯æŒ
            document.addEventListener('keydown', function(e) {
                if (e.code === 'Space' && !e.target.matches('input, textarea')) {
                    e.preventDefault();
                    userInteracted = true;
                    togglePlay();
                } else if (e.code === 'ArrowRight' && !e.target.matches('input, textarea')) {
                    e.preventDefault();
                    userInteracted = true;
                    switchSong();
                }
            });
            
            // é¡µé¢ç‚¹å‡»äº‹ä»¶ï¼Œç”¨äºè§£é™¤è‡ªåŠ¨æ’­æ”¾é™åˆ¶
            document.addEventListener('click', function() {
                userInteracted = true;
            });
            
            // åˆå§‹åŒ–æ˜¾ç¤º
            document.getElementById('musicInfo').textContent = songs[currentSongIndex].name;
            document.getElementById('musicCounter').textContent = '1/' + songs.length;
        }
        
        // åˆ‡æ¢æ’­æ”¾/æš‚åœ
        function togglePlay() {
            const playBtn = document.getElementById('playBtn');
            
            if (!isPlaying) {
                // å¦‚æœéŸ³é¢‘è¿˜æ²¡æœ‰è®¾ç½®æºï¼Œå…ˆè®¾ç½®æº
                if (!audio.src || audio.src !== songs[currentSongIndex].url) {
                    audio.src = songs[currentSongIndex].url;
                    document.getElementById('musicInfo').textContent = 'æ­£åœ¨åŠ è½½...';
                }
                
                // å°è¯•æ’­æ”¾
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        isPlaying = true;
                        playBtn.textContent = 'â¸ï¸';
                        playBtn.classList.add('playing');
                        document.getElementById('musicInfo').textContent = songs[currentSongIndex].name;
                    }).catch(error => {
                        console.error('æ’­æ”¾å¤±è´¥:', error);
                        if (error.name === 'NotAllowedError') {
                            document.getElementById('musicInfo').textContent = 'è¯·å…ˆç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®';
                        } else {
                            document.getElementById('musicInfo').textContent = 'æ’­æ”¾å¤±è´¥ï¼Œè¯·é‡è¯•';
                        }
                    });
                }
            } else {
                audio.pause();
                isPlaying = false;
                playBtn.textContent = 'â–¶ï¸';
                playBtn.classList.remove('playing');
            }
        }
        
        // è·å–éšæœºæ­Œæ›²ç´¢å¼•
        function getRandomSongIndex() {
            // å¦‚æœæ‰€æœ‰æ­Œæ›²éƒ½æ’­æ”¾è¿‡äº†ï¼Œé‡ç½®æ’­æ”¾å†å²
            if (playedSongs.length >= songs.length) {
                playedSongs = [];
                console.log('æ‰€æœ‰æ­Œæ›²å·²æ’­æ”¾å®Œæ¯•ï¼Œé‡æ–°å¼€å§‹éšæœºæ’­æ”¾');
            }
            
            // è·å–æœªæ’­æ”¾çš„æ­Œæ›²ç´¢å¼•
            const availableSongs = [];
            for (let i = 0; i < songs.length; i++) {
                if (!playedSongs.includes(i)) {
                    availableSongs.push(i);
                }
            }
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªæœªæ’­æ”¾çš„æ­Œæ›²
            const randomIndex = Math.floor(Math.random() * availableSongs.length);
            const selectedIndex = availableSongs[randomIndex];
            
            // è®°å½•å·²æ’­æ”¾çš„æ­Œæ›²
            playedSongs.push(selectedIndex);
            
            return selectedIndex;
        }
        
        // åˆ‡æ¢æ­Œæ›²
        function switchSong() {
            // è·å–éšæœºæ­Œæ›²ç´¢å¼•
            currentSongIndex = getRandomSongIndex();
            
            // è®°å½•å½“å‰æ’­æ”¾çŠ¶æ€
            const wasPlaying = isPlaying;
            
            // åœæ­¢å½“å‰æ’­æ”¾
            if (isPlaying) {
                audio.pause();
                isPlaying = false;
                document.getElementById('playBtn').textContent = 'â–¶ï¸';
                document.getElementById('playBtn').classList.remove('playing');
            }
            
            // æ˜¾ç¤ºåˆ‡æ¢æç¤º
            const musicInfo = document.getElementById('musicInfo');
            musicInfo.textContent = 'åˆ‡æ¢ä¸­...';
            
            // è®¾ç½®æ–°çš„éŸ³é¢‘æº
            audio.src = songs[currentSongIndex].url;
            
            // æ›´æ–°æ˜¾ç¤ºä¿¡æ¯
            document.getElementById('musicCounter').textContent = `${playedSongs.length}/${songs.length}`;
            document.getElementById('progressBar').style.width = '0%';
            
            // å¦‚æœä¹‹å‰åœ¨æ’­æ”¾ï¼Œåˆ™è‡ªåŠ¨æ’­æ”¾æ–°æ­Œæ›²
            if (wasPlaying && userInteracted) {
                setTimeout(() => {
                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            isPlaying = true;
                            document.getElementById('playBtn').textContent = 'â¸ï¸';
                            document.getElementById('playBtn').classList.add('playing');
                            musicInfo.textContent = songs[currentSongIndex].name;
                        }).catch(error => {
                            console.error('æ’­æ”¾å¤±è´¥:', error);
                            musicInfo.textContent = 'æ’­æ”¾å¤±è´¥ï¼Œè¯·é‡è¯•';
                        });
                    }
                }, 500);
            } else {
                // å¦‚æœç”¨æˆ·æ²¡æœ‰äº¤äº’è¿‡ï¼Œåªæ›´æ–°æ˜¾ç¤ºä¿¡æ¯
                musicInfo.textContent = songs[currentSongIndex].name;
            }
        }
        
        // è¯­è¨€åˆ‡æ¢åŠŸèƒ½
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'zh' ? 'en' : 'zh';
            updateLanguage();
        }
        
        // æ›´æ–°é¡µé¢è¯­è¨€
        function updateLanguage() {
            const lang = languages[currentLanguage];
            
            // æ›´æ–°é¡µé¢æ–‡æœ¬
            document.getElementById('mainTitle').textContent = lang.mainTitle;
            document.getElementById('welcomeTitle').textContent = lang.welcomeTitle;
            document.getElementById('loadingTip').textContent = lang.loadingTip;
            document.getElementById('welcomeText1').textContent = lang.welcomeText1;
            document.getElementById('welcomeText2').textContent = lang.welcomeText2;
            document.getElementById('aiFeatureText').textContent = lang.aiFeatureText;
            document.getElementById('softwareFeatureText').textContent = lang.softwareFeatureText;
            document.getElementById('footerText').textContent = lang.footerText;
            document.getElementById('languageSwitch').textContent = lang.languageButton;
        }
        
        // åŠ è½½æ—¶éŸ³ä¹æ’­æ”¾å™¨
        let loadingAudio = null;
        let loadingIsPlaying = false;
        let loadingCurrentSongIndex = 0;
        let loadingUserInteracted = false;
        
        // åŠ è½½æ—¶æ­Œæ›²åˆ—è¡¨
        const loadingSongs = [
            {
                url: 'https://music.163.com/song/media/outer/url?id=1846511389.mp3',
                name: 'Landslide - Oh Wonder'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=2086154795.mp3',
                name: 'Tek It - Cream Pie'
            },
            {
                url: 'https://music.163.com/song/media/outer/url?id=1862710424.mp3',
                name: 'Stay - The Kid LAROI/Justin Bieber'
            }
        ];
        
        // åˆ›å»ºåŠ è½½é¡µéŸ³é¢‘å¯¹è±¡
        function createLoadingAudioObject() {
            if (loadingAudio) {
                loadingAudio.pause();
                loadingAudio.removeEventListener('loadedmetadata', handleLoadingAudioLoaded);
                loadingAudio.removeEventListener('ended', handleLoadingAudioEnded);
                loadingAudio.removeEventListener('error', handleLoadingAudioError);
            }
            
            loadingAudio = new Audio();
            loadingAudio.preload = 'none';
            // ç§»é™¤ crossOrigin è®¾ç½®ï¼Œé¿å…CORSé™åˆ¶
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            loadingAudio.addEventListener('loadedmetadata', handleLoadingAudioLoaded);
            loadingAudio.addEventListener('ended', handleLoadingAudioEnded);
            loadingAudio.addEventListener('error', handleLoadingAudioError);
            
            return loadingAudio;
        }
        
        // åŠ è½½é¡µéŸ³é¢‘åŠ è½½å®Œæˆå¤„ç†
        function handleLoadingAudioLoaded() {
            updateLoadingSongInfo();
        }
        
        // åŠ è½½é¡µéŸ³é¢‘æ’­æ”¾ç»“æŸå¤„ç†
        function handleLoadingAudioEnded() {
            switchLoadingSong();
        }
        
        // åŠ è½½é¡µéŸ³é¢‘é”™è¯¯å¤„ç†
        function handleLoadingAudioError() {
            const loadingMusicInfo = document.getElementById('loadingMusicInfo');
            loadingMusicInfo.textContent = 'éŸ³ä¹åŠ è½½å¤±è´¥';
        }
        
        // æ›´æ–°åŠ è½½é¡µæ­Œæ›²ä¿¡æ¯æ˜¾ç¤º
        function updateLoadingSongInfo() {
            const loadingMusicInfo = document.getElementById('loadingMusicInfo');
            const loadingMusicCounter = document.getElementById('loadingMusicCounter');
            loadingMusicInfo.textContent = loadingSongs[loadingCurrentSongIndex].name;
            loadingMusicCounter.textContent = `${loadingCurrentSongIndex + 1}/${loadingSongs.length}`;
        }
        
        // åˆ‡æ¢åŠ è½½é¡µæ­Œæ›²
        function switchLoadingSong() {
            // æŒ‰é¡ºåºæ’­æ”¾æ­Œæ›²
            loadingCurrentSongIndex = (loadingCurrentSongIndex + 1) % loadingSongs.length;
            
            // è®°å½•å½“å‰æ’­æ”¾çŠ¶æ€
            const wasPlaying = loadingIsPlaying;
            
            // åœæ­¢å½“å‰æ’­æ”¾
            if (loadingIsPlaying) {
                loadingAudio.pause();
                loadingIsPlaying = false;
                document.getElementById('loadingPlayBtn').style.display = 'inline-block';
                document.getElementById('loadingPauseBtn').style.display = 'none';
            }
            
            // è®¾ç½®æ–°çš„éŸ³é¢‘æº
            loadingAudio.src = loadingSongs[loadingCurrentSongIndex].url;
            updateLoadingSongInfo();
            
            // å¦‚æœä¹‹å‰åœ¨æ’­æ”¾ï¼Œåˆ™è‡ªåŠ¨æ’­æ”¾æ–°æ­Œæ›²
            if (wasPlaying && loadingUserInteracted) {
                setTimeout(() => {
                    const playPromise = loadingAudio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            loadingIsPlaying = true;
                            document.getElementById('loadingPlayBtn').style.display = 'none';
                            document.getElementById('loadingPauseBtn').style.display = 'inline-block';
                        }).catch(error => {
                            console.error('åŠ è½½æ—¶éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
                            document.getElementById('loadingMusicInfo').textContent = 'éŸ³ä¹æ’­æ”¾å¤±è´¥';
                        });
                    }
                }, 500);
            }
        }
        
        // åˆå§‹åŒ–åŠ è½½æ—¶éŸ³ä¹æ’­æ”¾å™¨
        function initLoadingMusicPlayer() {
            const loadingPlayBtn = document.getElementById('loadingPlayBtn');
            const loadingPauseBtn = document.getElementById('loadingPauseBtn');
            const loadingSwitchBtn = document.getElementById('loadingSwitchBtn');
            
            // åˆ›å»ºéŸ³é¢‘å¯¹è±¡
            createLoadingAudioObject();
            
            // æ’­æ”¾æŒ‰é’®äº‹ä»¶
            loadingPlayBtn.addEventListener('click', function() {
                loadingUserInteracted = true;
                if (!loadingIsPlaying) {
                    // å¦‚æœéŸ³é¢‘è¿˜æ²¡æœ‰è®¾ç½®æºï¼Œå…ˆè®¾ç½®æº
                    if (!loadingAudio.src || loadingAudio.src !== loadingSongs[loadingCurrentSongIndex].url) {
                        loadingAudio.src = loadingSongs[loadingCurrentSongIndex].url;
                        document.getElementById('loadingMusicInfo').textContent = 'æ­£åœ¨åŠ è½½...';
                    }
                    
                    const playPromise = loadingAudio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            loadingIsPlaying = true;
                            loadingPlayBtn.style.display = 'none';
                            loadingPauseBtn.style.display = 'inline-block';
                            document.getElementById('loadingMusicInfo').textContent = loadingSongs[loadingCurrentSongIndex].name;
                        }).catch(error => {
                            console.error('åŠ è½½æ—¶éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
                            if (error.name === 'NotAllowedError') {
                                document.getElementById('loadingMusicInfo').textContent = 'è¯·å…ˆç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®';
                            } else {
                                document.getElementById('loadingMusicInfo').textContent = 'éŸ³ä¹æ’­æ”¾å¤±è´¥';
                            }
                        });
                    }
                }
            });
            
            // æš‚åœæŒ‰é’®äº‹ä»¶
            loadingPauseBtn.addEventListener('click', function() {
                loadingUserInteracted = true;
                if (loadingIsPlaying) {
                    loadingAudio.pause();
                    loadingIsPlaying = false;
                    loadingPlayBtn.style.display = 'inline-block';
                    loadingPauseBtn.style.display = 'none';
                }
            });
            
            // åˆ‡æ¢æŒ‰é’®äº‹ä»¶
            loadingSwitchBtn.addEventListener('click', function() {
                loadingUserInteracted = true;
                switchLoadingSong();
            });
            
            // åˆå§‹åŒ–æ˜¾ç¤º
            updateLoadingSongInfo();
        }
        
        // æ™ºèƒ½åŠ è½½ç³»ç»Ÿ
        let loadingProgress = 0;
        let loadingTasks = [];
        let isFullyLoaded = false;
        
        // æ·»åŠ åŠ è½½ä»»åŠ¡
        function addLoadingTask(taskName, taskFunction) {
            loadingTasks.push({
                name: taskName,
                function: taskFunction,
                completed: false
            });
        }
        
        // æ ‡è®°ä»»åŠ¡å®Œæˆ
        function markTaskComplete(taskName) {
            const task = loadingTasks.find(t => t.name === taskName);
            if (task) {
                task.completed = true;
                console.log(`ä»»åŠ¡å®Œæˆ: ${taskName}`);
                updateLoadingProgress();
            }
        }
        
        // æ›´æ–°åŠ è½½è¿›åº¦
        function updateLoadingProgress() {
            const completedTasks = loadingTasks.filter(t => t.completed).length;
            const totalTasks = loadingTasks.length;
            loadingProgress = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
            
            // æ›´æ–°è¿›åº¦æ¡
            const progressBar = document.getElementById('loadingProgressBar');
            if (progressBar) {
                progressBar.style.width = loadingProgress + '%';
            }
            
            const countdownElement = document.getElementById('loadingCountdown');
            if (countdownElement) {
                if (loadingProgress >= 100) {
                    countdownElement.textContent = 'åŠ è½½å®Œæˆï¼';
                    if (!isFullyLoaded) {
                        isFullyLoaded = true;
                        setTimeout(() => {
                            hideLoadingScreen();
                        }, 1000);
                    }
                } else if (loadingProgress >= 80) {
                    countdownElement.textContent = 'å³å°†å®Œæˆ...';
                } else if (loadingProgress >= 60) {
                    countdownElement.textContent = 'åŠ è½½è¿›åº¦è‰¯å¥½...';
                } else if (loadingProgress >= 40) {
                    countdownElement.textContent = 'æ­£åœ¨åŠ è½½æ ¸å¿ƒåŠŸèƒ½...';
                } else if (loadingProgress >= 20) {
                    countdownElement.textContent = 'åˆå§‹åŒ–ç³»ç»Ÿ...';
                } else {
                    countdownElement.textContent = 'æ­£åœ¨å‡†å¤‡ä½“éªŒ...';
                }
            }
        }
        
        // æ™ºèƒ½å€’è®¡æ—¶ï¼ˆä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼‰
        function startSmartCountdown() {
            let seconds = 0;
            const countdownElement = document.getElementById('loadingCountdown');
            const progressBar = document.getElementById('loadingProgressBar');
            
            const countdownInterval = setInterval(() => {
                seconds++;
                if (!isFullyLoaded) {
                    // æ¨¡æ‹Ÿè¿›åº¦æ¡åŠ¨ç”»
                    if (progressBar) {
                        const simulatedProgress = Math.min(seconds * 20, 100);
                        progressBar.style.width = simulatedProgress + '%';
                    }
                    
                    if (seconds <= 2) {
                        countdownElement.textContent = 'æ­£åœ¨å‡†å¤‡ä½“éªŒ...';
                    } else if (seconds <= 4) {
                        countdownElement.textContent = 'åˆå§‹åŒ–ç³»ç»Ÿ...';
                    } else if (seconds <= 6) {
                        countdownElement.textContent = 'æ­£åœ¨åŠ è½½æ ¸å¿ƒåŠŸèƒ½...';
                    } else if (seconds <= 8) {
                        countdownElement.textContent = 'åŠ è½½è¿›åº¦è‰¯å¥½...';
                    } else {
                        countdownElement.textContent = 'å³å°†å®Œæˆ...';
                        if (seconds >= 10) {
                            clearInterval(countdownInterval);
                            if (progressBar) {
                                progressBar.style.width = '100%';
                            }
                            countdownElement.textContent = 'åŠ è½½å®Œæˆï¼';
                            setTimeout(() => {
                                hideLoadingScreen();
                            }, 500);
                        }
                    }
                } else {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }
        
        // è°ƒè¯•å‡½æ•°ï¼šæ˜¾ç¤ºå½“å‰åŠ è½½çŠ¶æ€
        function debugLoadingStatus() {
            console.log('å½“å‰åŠ è½½çŠ¶æ€:');
            console.log('æ€»ä»»åŠ¡æ•°:', loadingTasks.length);
            console.log('å·²å®Œæˆä»»åŠ¡æ•°:', loadingTasks.filter(t => t.completed).length);
            console.log('åŠ è½½è¿›åº¦:', loadingProgress + '%');
            console.log('æ˜¯å¦å®Œå…¨åŠ è½½:', isFullyLoaded);
            loadingTasks.forEach(task => {
                console.log(`- ${task.name}: ${task.completed ? 'å®Œæˆ' : 'è¿›è¡Œä¸­'}`);
            });
        }
        
        // è°ƒè¯•å‡½æ•°ï¼šæ˜¾ç¤ºå¤©æ°”åˆ·æ–°çŠ¶æ€
        function debugWeatherStatus() {
            const refreshCount = parseInt(localStorage.getItem('weatherRefreshCount') || '0');
            const lastRefreshTime = localStorage.getItem('weatherLastRefreshTime');
            const now = Date.now();
            const timeSinceLastRefresh = lastRefreshTime ? (now - parseInt(lastRefreshTime)) : Infinity;
            const remainingFree = Math.max(0, 3 - refreshCount);
            const isInCooldown = timeSinceLastRefresh < 5 * 1000 && refreshCount >= 3;
            
            console.log('=== å¤©æ°”åˆ·æ–°çŠ¶æ€ ===');
            console.log('å½“å‰åˆ·æ–°æ¬¡æ•°:', refreshCount);
            console.log('å‰©ä½™å…è´¹æ¬¡æ•°:', remainingFree);
            console.log('è·ç¦»ä¸Šæ¬¡åˆ·æ–°:', Math.floor(timeSinceLastRefresh / 1000), 'ç§’');
            console.log('æ˜¯å¦åœ¨å†·å´ä¸­:', isInCooldown);
            if (isInCooldown) {
                const remainingCooldown = Math.ceil((5 * 1000 - timeSinceLastRefresh) / 1000);
                console.log('å†·å´å‰©ä½™æ—¶é—´:', remainingCooldown, 'ç§’');
            }
            console.log('==================');
        }
        
        // è°ƒè¯•å‡½æ•°ï¼šæ˜¾ç¤ºä½ç½®ä¿¡æ¯
        function debugLocationInfo() {
            console.log('=== ä½ç½®ä¿¡æ¯ ===');
            console.log('ç¼“å­˜ä½ç½®:', cachedLocation);
            console.log('ä½ç½®ç¼“å­˜:', localStorage.getItem('weatherLocation'));
            console.log('ä½ç½®ç¼“å­˜æ—¶é—´:', localStorage.getItem('weatherLocationTime'));
            
            if (cachedLocation) {
                const estimatedCity = estimateCityFromCoordinates(cachedLocation.latitude, cachedLocation.longitude);
                console.log('åæ ‡ä¼°ç®—åŸå¸‚:', estimatedCity);
            }
            console.log('==================');
        }
        
        // è°ƒè¯•å‡½æ•°ï¼šæ˜¾ç¤ºæ‰€æœ‰ç¼“å­˜ä¿¡æ¯
        function debugAllCache() {
            console.log('=== æ‰€æœ‰ç¼“å­˜ä¿¡æ¯ ===');
            console.log('ä½ç½®ç¼“å­˜:', localStorage.getItem('weatherLocation'));
            console.log('ä½ç½®ç¼“å­˜æ—¶é—´:', localStorage.getItem('weatherLocationTime'));
            console.log('å¤©æ°”ç¼“å­˜:', localStorage.getItem('weatherData'));
            console.log('å¤©æ°”ç¼“å­˜æ—¶é—´:', localStorage.getItem('weatherCacheTime'));
            console.log('åˆ·æ–°æ¬¡æ•°:', localStorage.getItem('weatherRefreshCount'));
            console.log('ä¸Šæ¬¡åˆ·æ–°æ—¶é—´:', localStorage.getItem('weatherLastRefreshTime'));
            console.log('å…¨å±€ç¼“å­˜ä½ç½®:', cachedLocation);
            console.log('==================');
        }
        
        // å›¾ç‰‡é¢„åŠ è½½å‡½æ•°ï¼ˆä¼˜å…ˆWebPï¼‰
        function preloadBackgroundImage() {
            const webpImage = '/assets/img/erd.webp';
            const jpgImage = '/assets/img/erd.jpg';
            
            // å…ˆå°è¯•åŠ è½½WebP
            const img = new Image();
            img.onload = function() {
                document.body.style.backgroundImage = `url('${webpImage}')`;
                document.body.classList.add('loaded');
                console.log('WebPèƒŒæ™¯å›¾ç‰‡åŠ è½½å®Œæˆ:', webpImage);
                markTaskComplete('backgroundImage');
            };
            img.onerror = function() {
                // WebPåŠ è½½å¤±è´¥ï¼Œå›é€€åˆ°JPG
                console.log('WebPåŠ è½½å¤±è´¥ï¼Œå›é€€åˆ°JPG');
                const jpgImg = new Image();
                jpgImg.onload = function() {
                    document.body.style.backgroundImage = `url('${jpgImage}')`;
                    document.body.classList.add('loaded');
                    console.log('JPGèƒŒæ™¯å›¾ç‰‡åŠ è½½å®Œæˆ:', jpgImage);
                    markTaskComplete('backgroundImage');
                };
                jpgImg.onerror = function() {
                    console.log('æ‰€æœ‰èƒŒæ™¯å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ¸å˜èƒŒæ™¯');
                    markTaskComplete('backgroundImage');
                };
                jpgImg.src = jpgImage;
            };
            img.src = webpImage;
        }
        
        // å¿«é€Ÿé¢„åŠ è½½èƒŒæ™¯å›¾ç‰‡ï¼ˆç”¨äºè¿”å›æ—¶ï¼Œä¼˜å…ˆWebPï¼‰
        function quickPreloadBackgroundImage() {
            const webpImage = '/assets/img/erd.webp';
            const jpgImage = '/assets/img/erd.jpg';
            
            // å…ˆå°è¯•åŠ è½½WebP
            const img = new Image();
            img.onload = function() {
                document.body.style.backgroundImage = `url('${webpImage}')`;
                document.body.classList.add('loaded');
            };
            img.onerror = function() {
                // WebPåŠ è½½å¤±è´¥ï¼Œå›é€€åˆ°JPG
                const jpgImg = new Image();
                jpgImg.onload = function() {
                    document.body.style.backgroundImage = `url('${jpgImage}')`;
                    document.body.classList.add('loaded');
                };
                jpgImg.onerror = function() {
                    console.log('èƒŒæ™¯å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ¸å˜èƒŒæ™¯');
                };
                jpgImg.src = jpgImage;
            };
            img.src = webpImage;
        }
        
        // å¿«é€ŸåŠ è½½ç¼“å­˜çš„å¤©æ°”æ•°æ®ï¼ˆç”¨äºè¿”å›æ—¶ï¼‰
        function quickLoadWeather() {
            const weatherWidget = document.getElementById('weatherWidget');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            weatherWidget.innerHTML = `
                <div class="weather-loading">
                    <div class="spinner"></div>
                    <span>åŠ è½½å¤©æ°”ä¸­...</span>
                </div>
            `;
            
            try {
                // é¦–å…ˆæ¢å¤ç¼“å­˜çš„ä½ç½®ä¿¡æ¯
                const cachedLocationData = localStorage.getItem('weatherLocation');
                if (cachedLocationData) {
                    cachedLocation = JSON.parse(cachedLocationData);
                    console.log('ä»å…¶ä»–é¡µé¢è¿”å›ï¼Œæ¢å¤ç¼“å­˜ä½ç½®:', cachedLocation);
                } else {
                    console.log('ä»å…¶ä»–é¡µé¢è¿”å›ï¼Œæ²¡æœ‰ç¼“å­˜ä½ç½®ä¿¡æ¯');
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜çš„å¤©æ°”æ•°æ®
                const cachedData = localStorage.getItem('weatherData');
                const cacheTime = localStorage.getItem('weatherCacheTime');
                const now = Date.now();
                
                if (cachedData && cacheTime && (now - parseInt(cacheTime)) < 30 * 60 * 1000) {
                    // ä½¿ç”¨ç¼“å­˜çš„å¤©æ°”æ•°æ®
                    console.log('ä»å…¶ä»–é¡µé¢è¿”å›ï¼Œä½¿ç”¨ç¼“å­˜å¤©æ°”æ•°æ®');
                    const weatherData = JSON.parse(cachedData);
                    updateWeatherDisplay(weatherData);
                    isWeatherLoaded = true;
                } else {
                    // ç¼“å­˜è¿‡æœŸæˆ–ä¸å­˜åœ¨ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
                    console.log('ä»å…¶ä»–é¡µé¢è¿”å›ï¼Œç¼“å­˜å·²è¿‡æœŸï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€');
                    weatherWidget.innerHTML = `
                        <div class="weather-loading">
                            <div class="spinner"></div>
                            <span>åŠ è½½å¤©æ°”ä¸­...</span>
                        </div>
                    `;
                    // å¼‚æ­¥åŠ è½½æ–°æ•°æ®
                    loadWeather().then(() => {
                        isWeatherLoaded = true;
                    });
                }
            } catch (error) {
                console.error('å¿«é€ŸåŠ è½½å¤©æ°”å¤±è´¥:', error);
                weatherWidget.innerHTML = `
                    <div class="weather-loading">
                        <div class="spinner"></div>
                        <span>åŠ è½½å¤©æ°”ä¸­...</span>
                    </div>
                `;
                // å¼‚æ­¥åŠ è½½æ–°æ•°æ®
                loadWeather().then(() => {
                    isWeatherLoaded = true;
                });
            }
        }
        
        // éšè—åŠ è½½å±å¹•
        function hideLoadingScreen() {
            // åœæ­¢åŠ è½½æ—¶éŸ³ä¹æ’­æ”¾
            if (loadingAudio && loadingIsPlaying) {
                loadingAudio.pause();
                loadingIsPlaying = false;
            }
            
            const loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen) {
                loadingScreen.classList.add('hidden');
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥æ˜¯å¦æ˜¯ä»å…¶ä»–é¡µé¢è¿”å›
            const isReturning = sessionStorage.getItem('returningFromOtherPage');
            
            if (isReturning) {
                // ä»å…¶ä»–é¡µé¢è¿”å›ï¼Œç›´æ¥æ˜¾ç¤ºä¸»é¡µé¢ï¼Œä¸æ˜¾ç¤ºåŠ è½½é¡µé¢
                sessionStorage.removeItem('returningFromOtherPage');
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                // å¿«é€Ÿé¢„åŠ è½½èƒŒæ™¯å›¾ç‰‡ï¼Œä¸æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
                quickPreloadBackgroundImage();
                // å¼‚æ­¥åŠ è½½å¤©æ°”æ•°æ®ï¼ˆä¸é˜»å¡ä¸»é¡µé¢æ˜¾ç¤ºï¼‰
                setTimeout(() => {
                    if (!isWeatherLoaded) {
                        console.log('ä»å…¶ä»–é¡µé¢è¿”å›ï¼Œå¼‚æ­¥åŠ è½½å¤©æ°”æ•°æ®...');
                        quickLoadWeather();
                    } else {
                        console.log('å¤©æ°”æ•°æ®å·²åŠ è½½ï¼Œè·³è¿‡é‡å¤åŠ è½½');
                    }
                }, 500); // å»¶è¿Ÿ0.5ç§’å¼€å§‹åŠ è½½å¤©æ°”
            } else {
                // æ­£å¸¸è®¿é—®ï¼Œæ˜¾ç¤ºåŠ è½½é¡µé¢
                // åˆå§‹åŒ–æ™ºèƒ½åŠ è½½ç³»ç»Ÿï¼ˆå¤©æ°”ä»»åŠ¡ä¸é˜»å¡ä¸»é¡µé¢æ˜¾ç¤ºï¼‰
                addLoadingTask('backgroundImage', preloadBackgroundImage);
                addLoadingTask('loadingMusicPlayer', initLoadingMusicPlayer);
                addLoadingTask('particles', createParticles);
                addLoadingTask('cursorTrail', initCursorTrail);
                addLoadingTask('mainMusicPlayer', initMusicPlayer);
                addLoadingTask('konamiCode', initKonamiCode);
                
                // å¼€å§‹æ™ºèƒ½å€’è®¡æ—¶ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
                startSmartCountdown();
                
                // æ‰§è¡ŒåŠ è½½ä»»åŠ¡
                preloadBackgroundImage();
                initLoadingMusicPlayer();
                markTaskComplete('loadingMusicPlayer');
                markTaskComplete('particles');
                markTaskComplete('cursorTrail');
                markTaskComplete('mainMusicPlayer');
                markTaskComplete('konamiCode');
                
                // æ‰§è¡Œå¤©æ°”åŠ è½½ä»»åŠ¡ï¼ˆå·²åœ¨åŠ è½½ä»»åŠ¡ä¸­å¤„ç†ï¼‰
                // loadWeatherWithCache() ä¼šåœ¨åŠ è½½ä»»åŠ¡ä¸­è‡ªåŠ¨è°ƒç”¨
            }
            
            // ç¡®ä¿æ‰€æœ‰åŠŸèƒ½éƒ½æ­£ç¡®åˆå§‹åŒ–
            createParticles();
            initCursorTrail();
            initMusicPlayer();
            initKonamiCode();
            
            // å¼‚æ­¥åŠ è½½å¤©æ°”æ•°æ®ï¼ˆä¸é˜»å¡ä¸»é¡µé¢æ˜¾ç¤ºï¼‰
            setTimeout(() => {
                if (!isWeatherLoaded) {
                    console.log('ä¸»é¡µé¢å·²æ˜¾ç¤ºï¼Œå¼€å§‹å¼‚æ­¥åŠ è½½å¤©æ°”æ•°æ®...');
                    loadWeatherWithCache().catch(error => {
                        console.error('å¼‚æ­¥å¤©æ°”åŠ è½½å¤±è´¥:', error);
                    });
                } else {
                    console.log('å¤©æ°”æ•°æ®å·²åŠ è½½ï¼Œè·³è¿‡é‡å¤åŠ è½½');
                }
            }, 1000); // å»¶è¿Ÿ1ç§’å¼€å§‹åŠ è½½å¤©æ°”
            
            // è¯­è¨€åˆ‡æ¢åŠŸèƒ½
            const languageSwitch = document.getElementById('languageSwitch');
            languageSwitch.addEventListener('click', toggleLanguage);
            
            // åŠŸèƒ½å¡ç‰‡ç‚¹å‡»äº‹ä»¶
            document.getElementById('aiFeatureCard').addEventListener('click', function() {
                window.location.href = '/ai';
            });
            
            document.getElementById('softwareFeatureCard').addEventListener('click', function() {
                window.location.href = '/downloads';
            });
        });
        
        // å…¨å±€å˜é‡å­˜å‚¨ä½ç½®å’Œå¤©æ°”æ•°æ®
        let cachedLocation = null;
        let cachedWeatherData = null;
        let isWeatherLoading = false; // é˜²æ­¢é‡å¤è¯·æ±‚
        let isWeatherLoaded = false; // é˜²æ­¢é‡å¤åŠ è½½
        let isLocationDenied = false; // è®°ä½ç”¨æˆ·æ˜¯å¦æ‹’ç»è¿‡ä½ç½®æƒé™
        
        // å¸¦ç¼“å­˜çš„å¤©æ°”åŠ è½½å‡½æ•°ï¼ˆä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼‰
        async function loadWeatherWithCache() {
            const weatherWidget = document.getElementById('weatherWidget');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            weatherWidget.innerHTML = `
                <div class="weather-loading">
                    <div class="spinner"></div>
                    <span>åŠ è½½å¤©æ°”ä¸­...</span>
                </div>
            `;
            
            try {
                // é¦–å…ˆæ¢å¤ç¼“å­˜çš„ä½ç½®ä¿¡æ¯
                const cachedLocationData = localStorage.getItem('weatherLocation');
                if (cachedLocationData) {
                    cachedLocation = JSON.parse(cachedLocationData);
                    console.log('æ¢å¤ç¼“å­˜ä½ç½®:', cachedLocation);
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜çš„å¤©æ°”æ•°æ®
                const cachedData = localStorage.getItem('weatherData');
                const cacheTime = localStorage.getItem('weatherCacheTime');
                const now = Date.now();
                
                if (cachedData && cacheTime && (now - parseInt(cacheTime)) < 30 * 60 * 1000) {
                    // ä½¿ç”¨ç¼“å­˜çš„å¤©æ°”æ•°æ®
                    console.log('ä½¿ç”¨ç¼“å­˜å¤©æ°”æ•°æ®');
                    const weatherData = JSON.parse(cachedData);
                    updateWeatherDisplay(weatherData);
                    isWeatherLoaded = true;
                    markTaskComplete('weatherData');
                    return Promise.resolve();
                } else {
                    // ç¼“å­˜è¿‡æœŸæˆ–ä¸å­˜åœ¨ï¼ŒåŠ è½½æ–°æ•°æ®
                    console.log('ç¼“å­˜è¿‡æœŸæˆ–ä¸å­˜åœ¨ï¼ŒåŠ è½½æ–°å¤©æ°”æ•°æ®');
                    const result = await loadWeatherForce();
                    isWeatherLoaded = true;
                    markTaskComplete('weatherData');
                    return result;
                }
            } catch (error) {
                console.error('åŠ è½½ç¼“å­˜å¤©æ°”å¤±è´¥:', error);
                const result = await loadWeatherForce();
                isWeatherLoaded = true;
                markTaskComplete('weatherData');
                return result;
            }
        }
        
        // å¼ºåˆ¶è·å–å…¨æ–°å¤©æ°”æ•°æ®ï¼ˆä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ï¼‰
        async function loadWeatherForce() {
            // é˜²æ­¢é‡å¤è¯·æ±‚
            if (isWeatherLoading) {
                console.log('å¤©æ°”æ•°æ®æ­£åœ¨åŠ è½½ä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚');
                return Promise.resolve();
            }
            
            isWeatherLoading = true;
            const weatherWidget = document.getElementById('weatherWidget');
            
            try {
                console.log('å¼ºåˆ¶è·å–å…¨æ–°ä½ç½®å’Œå¤©æ°”æ•°æ®...');
                
                // å¼ºåˆ¶è·å–æ–°ä½ç½®
                const position = await getCurrentPosition();
                cachedLocation = {
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude
                };
                console.log('è·å–åˆ°æ–°ä½ç½®:', cachedLocation);
                
                // ä¿å­˜æ–°ä½ç½®åˆ°ç¼“å­˜
                const currentTime = Date.now();
                localStorage.setItem('weatherLocation', JSON.stringify(cachedLocation));
                localStorage.setItem('weatherLocationTime', currentTime.toString());
                console.log('ä½ç½®ç¼“å­˜å·²ä¿å­˜:', cachedLocation);
                
                // å¼ºåˆ¶è·å–æ–°å¤©æ°”æ•°æ®
                console.log('è·å–å…¨æ–°å¤©æ°”æ•°æ®...');
                const weatherData = await fetchWeatherData(cachedLocation.latitude, cachedLocation.longitude);
                
                // ä¿å­˜æ–°å¤©æ°”æ•°æ®åˆ°ç¼“å­˜
                localStorage.setItem('weatherData', JSON.stringify(weatherData));
                localStorage.setItem('weatherCacheTime', currentTime.toString());
                console.log('å¤©æ°”ç¼“å­˜å·²ä¿å­˜ï¼Œæ—¶é—´:', new Date(currentTime).toLocaleString());
                
                updateWeatherDisplay(weatherData);
                isWeatherLoading = false;
                markTaskComplete('weatherData');
                return Promise.resolve();
                
            } catch (error) {
                console.error('å¼ºåˆ¶è·å–å¤©æ°”å¤±è´¥:', error);
                weatherWidget.innerHTML = `
                    <div class="weather-error">
                        <div>ğŸŒ¤ï¸ å¤©æ°”ä¿¡æ¯</div>
                        <div style="font-size: 0.8em; margin-top: 5px;">æš‚æ—¶æ— æ³•è·å–</div>
                        <div style="font-size: 0.7em; margin-top: 3px; opacity: 0.7;">${error.message}</div>
                        <div class="weather-refresh-tip" style="font-size: 0.7em; opacity: 0.7; margin-top: 5px;">ç‚¹å‡»åˆ·æ–°ä½ç½®</div>
                    </div>
                `;
                isWeatherLoading = false;
                return Promise.reject(error);
            }
        }
        
        // å¤©æ°”åŠŸèƒ½
        async function loadWeather() {
            // é˜²æ­¢é‡å¤è¯·æ±‚
            if (isWeatherLoading) {
                console.log('å¤©æ°”æ•°æ®æ­£åœ¨åŠ è½½ä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚');
                return Promise.resolve();
            }
            
            isWeatherLoading = true;
            const weatherWidget = document.getElementById('weatherWidget');
            
            try {
                // æ£€æŸ¥ä½ç½®ç¼“å­˜æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡1å°æ—¶åˆ™é‡æ–°è·å–ä½ç½®
                const locationCacheTime = localStorage.getItem('weatherLocationTime');
                const currentTime = Date.now();
                const shouldRefreshLocation = !locationCacheTime || (currentTime - parseInt(locationCacheTime)) > 60 * 60 * 1000; // 1å°æ—¶
                
                // é¦–å…ˆå°è¯•ä»localStorageè¯»å–ç¼“å­˜çš„ä½ç½®æ•°æ®
                const cachedLocationData = localStorage.getItem('weatherLocation');
                if (cachedLocationData && !shouldRefreshLocation) {
                    cachedLocation = JSON.parse(cachedLocationData);
                    console.log('ä½¿ç”¨ç¼“å­˜ä½ç½®:', cachedLocation);
                } else {
                    // éœ€è¦åˆ·æ–°ä½ç½®æˆ–æ²¡æœ‰ç¼“å­˜
                    console.log('å¼€å§‹è·å–æ–°ä½ç½®...');
                    const position = await getCurrentPosition();
                    cachedLocation = {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude
                    };
                    console.log('è·å–åˆ°æ–°ä½ç½®:', cachedLocation);
                    // å°†ä½ç½®æ•°æ®å’Œæ—¶é—´å­˜å‚¨åˆ°localStorage
                    localStorage.setItem('weatherLocation', JSON.stringify(cachedLocation));
                    localStorage.setItem('weatherLocationTime', currentTime.toString());
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜çš„å¤©æ°”æ•°æ®ä¸”ä¸è¶…è¿‡30åˆ†é’Ÿ
                const cachedData = localStorage.getItem('weatherData');
                const cacheTime = localStorage.getItem('weatherCacheTime');
                const now = Date.now();
                
                if (cachedData && cacheTime && (now - parseInt(cacheTime)) < 30 * 60 * 1000) {
                    // ä½¿ç”¨ç¼“å­˜çš„å¤©æ°”æ•°æ®
                    console.log('ä½¿ç”¨ç¼“å­˜å¤©æ°”æ•°æ®');
                    const weatherData = JSON.parse(cachedData);
                    updateWeatherDisplay(weatherData);
                    isWeatherLoading = false;
                    return Promise.resolve();
                }
                
                // è·å–æ–°çš„å¤©æ°”æ•°æ®
                console.log('è·å–æ–°å¤©æ°”æ•°æ®...');
                const weatherData = await fetchWeatherData(cachedLocation.latitude, cachedLocation.longitude);
                
                // ç¼“å­˜å¤©æ°”æ•°æ®
                localStorage.setItem('weatherData', JSON.stringify(weatherData));
                localStorage.setItem('weatherCacheTime', now.toString());
                
                updateWeatherDisplay(weatherData);
                isWeatherLoading = false;
                markTaskComplete('weatherData');
                return Promise.resolve();
                
            } catch (error) {
                console.error('å¤©æ°”åŠ è½½å¤±è´¥:', error);
                weatherWidget.innerHTML = `
                    <div class="weather-error">
                        <div>ğŸŒ¤ï¸ å¤©æ°”ä¿¡æ¯</div>
                        <div style="font-size: 0.8em; margin-top: 5px;">æš‚æ—¶æ— æ³•è·å–</div>
                        <div style="font-size: 0.7em; margin-top: 3px; opacity: 0.7;">${error.message}</div>
                        <div class="weather-refresh-tip" style="font-size: 0.7em; opacity: 0.7; margin-top: 5px;">ç‚¹å‡»åˆ·æ–°ä½ç½®</div>
                    </div>
                `;
                isWeatherLoading = false;
                return Promise.reject(error);
            }
        }
        
        // æ¸…é™¤å¤©æ°”ç¼“å­˜ï¼ˆç”¨äºè°ƒè¯•ï¼‰
        function clearWeatherCache() {
            localStorage.removeItem('weatherLocation');
            localStorage.removeItem('weatherLocationTime');
            localStorage.removeItem('weatherData');
            localStorage.removeItem('weatherCacheTime');
            localStorage.removeItem('weatherLastRefreshTime');
            localStorage.removeItem('weatherRefreshCount');
            cachedLocation = null;
            console.log('å¤©æ°”ç¼“å­˜å·²æ¸…é™¤');
        }
        
        // é‡ç½®åˆ·æ–°æ¬¡æ•°ï¼ˆç”¨äºæµ‹è¯•ï¼‰
        function resetRefreshCount() {
            localStorage.removeItem('weatherRefreshCount');
            localStorage.removeItem('weatherLastRefreshTime');
            console.log('åˆ·æ–°æ¬¡æ•°å·²é‡ç½®');
            // é‡æ–°åŠ è½½å¤©æ°”ä»¥æ›´æ–°æ˜¾ç¤º
            loadWeatherWithCache();
        }
        
        // å¼ºåˆ¶æ¸…é™¤æ‰€æœ‰å¤©æ°”ç›¸å…³ç¼“å­˜ï¼ˆç”¨äºæµ‹è¯•ï¼‰
        function forceClearAllWeatherCache() {
            localStorage.removeItem('weatherLocation');
            localStorage.removeItem('weatherLocationTime');
            localStorage.removeItem('weatherData');
            localStorage.removeItem('weatherCacheTime');
            localStorage.removeItem('weatherLastRefreshTime');
            localStorage.removeItem('weatherRefreshCount');
            cachedLocation = null;
            console.log('æ‰€æœ‰å¤©æ°”ç¼“å­˜å·²å¼ºåˆ¶æ¸…é™¤');
            // é‡æ–°åŠ è½½å¤©æ°”
            loadWeatherWithCache();
        }
        
        // æ‰‹åŠ¨å®Œæˆå¤©æ°”ä»»åŠ¡ï¼ˆç”¨äºè°ƒè¯•ï¼‰
        function forceCompleteWeatherTask() {
            markTaskComplete('weatherData');
            console.log('å¤©æ°”ä»»åŠ¡å·²æ‰‹åŠ¨å®Œæˆ');
        }
        
        // é‡ç½®ä½ç½®æ‹’ç»çŠ¶æ€ï¼ˆè°ƒè¯•ç”¨ï¼‰
        function resetLocationDenied() {
            isLocationDenied = false;
            console.log('ä½ç½®æ‹’ç»çŠ¶æ€å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°è¯·æ±‚ä½ç½®æƒé™');
        }
        
        // å¼ºåˆ¶é‡ç½®ä½ç½®æ‹’ç»çŠ¶æ€ï¼ˆè°ƒè¯•ç”¨ï¼‰
        function forceResetLocationDenied() {
            isLocationDenied = false;
            window.isRefreshingWeather = false;
            console.log('ä½ç½®æ‹’ç»çŠ¶æ€å·²å¼ºåˆ¶é‡ç½®ï¼Œå¯ä»¥é‡æ–°è¯·æ±‚ä½ç½®æƒé™');
        }
        
        // æ¨¡æ‹Ÿæ–°ç”¨æˆ·è®¿é—®ï¼ˆæ¸…é™¤æ‰€æœ‰ç¼“å­˜å¹¶é‡æ–°åŠ è½½ï¼‰
        function simulateNewUser() {
            console.log('=== æ¨¡æ‹Ÿæ–°ç”¨æˆ·è®¿é—® ===');
            
            // æ¸…é™¤æ‰€æœ‰å¤©æ°”ç›¸å…³ç¼“å­˜
            forceClearAllWeatherCache();
            
            // æ¸…é™¤sessionStorageï¼ˆè¿”å›æ ‡è®°ï¼‰
            sessionStorage.removeItem('returningFromOtherPage');
            
            // æ¸…é™¤å…¶ä»–å¯èƒ½çš„ç¼“å­˜
            localStorage.removeItem('weatherLocation');
            localStorage.removeItem('weatherLocationTime');
            localStorage.removeItem('weatherData');
            localStorage.removeItem('weatherCacheTime');
            localStorage.removeItem('weatherLastRefreshTime');
            localStorage.removeItem('weatherRefreshCount');
            
            // é‡ç½®å…¨å±€å˜é‡
            cachedLocation = null;
            cachedWeatherData = null;
            isWeatherLoading = false;
            isWeatherLoaded = false;
            isLocationDenied = false;
            
            console.log('æ‰€æœ‰ç¼“å­˜å·²æ¸…é™¤ï¼Œæ¨¡æ‹Ÿæ–°ç”¨æˆ·è®¿é—®');
            console.log('è¯·åˆ·æ–°é¡µé¢ä»¥é‡æ–°åŠ è½½æ‰€æœ‰æ•°æ®');
        }
        
        // æ‰‹åŠ¨åˆ·æ–°ä½ç½®å’Œå¤©æ°”ï¼ˆç”¨æˆ·ä¸»åŠ¨è§¦å‘ï¼‰
        async function refreshLocationAndWeather() {
            console.log('ç”¨æˆ·ä¸»åŠ¨åˆ·æ–°ä½ç½®å’Œå¤©æ°”...');
            
            // è·å–å½“å‰åˆ·æ–°æ¬¡æ•°
            let refreshCount = parseInt(localStorage.getItem('weatherRefreshCount') || '0');
            const lastRefreshTime = localStorage.getItem('weatherLastRefreshTime');
            const now = Date.now();
            const timeSinceLastRefresh = lastRefreshTime ? (now - parseInt(lastRefreshTime)) : Infinity;
            
            // å¦‚æœè·ç¦»ä¸Šæ¬¡åˆ·æ–°ä¸åˆ°5ç§’ä¸”å·²ç”¨å®Œå…è´¹æ¬¡æ•°ï¼Œç›´æ¥è¿”å›ä¸æ‰§è¡Œåˆ·æ–°
            if (timeSinceLastRefresh < 5 * 1000 && refreshCount >= 3) {
                return;
            }
            
            // å¢åŠ åˆ·æ–°æ¬¡æ•°
            refreshCount++;
            localStorage.setItem('weatherRefreshCount', refreshCount.toString());
            localStorage.setItem('weatherLastRefreshTime', now.toString());
            
            // è®¾ç½®åˆ·æ–°æ ‡å¿—ï¼Œå…è®¸é‡æ–°è¯·æ±‚ä½ç½®æƒé™
            window.isRefreshingWeather = true;
            
            // æ¸…é™¤æ‰€æœ‰ç¼“å­˜ï¼Œå¼ºåˆ¶è·å–å…¨æ–°æ•°æ®
            localStorage.removeItem('weatherLocation');
            localStorage.removeItem('weatherLocationTime');
            localStorage.removeItem('weatherData');
            localStorage.removeItem('weatherCacheTime');
            cachedLocation = null;
            cachedWeatherData = null;
            
            try {
                // å¼ºåˆ¶è·å–å…¨æ–°æ•°æ®ï¼ˆä¸ä½¿ç”¨ç¼“å­˜ï¼‰
                await loadWeatherForce();
            } finally {
                // æ¸…é™¤åˆ·æ–°æ ‡å¿—
                window.isRefreshingWeather = false;
            }
        }
        

        
        // Konamiä»£ç å½©è›‹åŠŸèƒ½
        function initKonamiCode() {
            const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 
                               'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 
                               'b', 'a'];
            let inputSequence = [];
            
            document.addEventListener('keydown', (e) => {
                inputSequence.push(e.key);
                if (inputSequence.length > konamiCode.length) {
                    inputSequence.shift();
                }
                
                if (JSON.stringify(inputSequence) === JSON.stringify(konamiCode)) {
                    // è§¦å‘å½©è›‹æ•ˆæœ
                    triggerKonamiEasterEgg();
                }
            });
        }
        
        // è§¦å‘Konamiå½©è›‹æ•ˆæœ - è¡¨æƒ…é›¨
        function triggerKonamiEasterEgg() {
            // è¡¨æƒ…æ•°ç»„
            const emojis = ['ğŸ‰', 'ğŸŠ', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«', 'ğŸˆ', 'ğŸ', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ¯', 'ğŸ²', 'ğŸ®', 'ğŸ¸', 'ğŸº', 'ğŸ»', 'ğŸ¼', 'ğŸµ', 'ğŸ¶', 'ğŸ¤', 'ğŸ§', 'ğŸ¬', 'ğŸ­', 'ğŸª', 'ğŸ¨', 'ğŸ¯', 'ğŸ²', 'ğŸ®', 'ğŸ¸', 'ğŸº', 'ğŸ»', 'ğŸ¼', 'ğŸµ', 'ğŸ¶', 'ğŸ¤', 'ğŸ§', 'ğŸ¬', 'ğŸ­', 'ğŸª', 'ğŸ¨', 'ğŸ¯', 'ğŸ²', 'ğŸ®', 'ğŸ¸', 'ğŸº', 'ğŸ»', 'ğŸ¼', 'ğŸµ', 'ğŸ¶', 'ğŸ¤', 'ğŸ§', 'ğŸ¬'];
            
            // åˆ›å»ºè¡¨æƒ…é›¨å®¹å™¨
            const emojiRain = document.createElement('div');
            emojiRain.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 9999;
                overflow: hidden;
            `;
            document.body.appendChild(emojiRain);
            
            // æ·»åŠ è¡¨æƒ…é›¨åŠ¨ç”»æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                @keyframes emojiFall {
                    0% {
                        transform: translateY(-100px) rotate(0deg);
                        opacity: 1;
                    }
                    100% {
                        transform: translateY(100vh) rotate(360deg);
                        opacity: 0;
                    }
                }
                @keyframes emojiBounce {
                    0%, 100% {
                        transform: translateY(-100px) scale(1);
                    }
                    50% {
                        transform: translateY(50vh) scale(1.2);
                    }
                }
            `;
            document.head.appendChild(style);
            
            // åˆ›å»ºè¡¨æƒ…é›¨
            let emojiCount = 0;
            const maxEmojis = 50;
            const rainDuration = 3000; // 3ç§’
            const emojiInterval = 60; // æ¯60msåˆ›å»ºä¸€ä¸ªè¡¨æƒ…
            
            const createEmoji = () => {
                if (emojiCount >= maxEmojis) return;
                
                const emoji = document.createElement('div');
                emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.cssText = `
                    position: absolute;
                    font-size: ${20 + Math.random() * 30}px;
                    left: ${Math.random() * 100}%;
                    animation: ${Math.random() > 0.5 ? 'emojiFall' : 'emojiBounce'} ${2 + Math.random() * 3}s linear forwards;
                    z-index: ${Math.floor(Math.random() * 10)};
                `;
                
                emojiRain.appendChild(emoji);
                emojiCount++;
                
                // åŠ¨ç”»ç»“æŸåç§»é™¤è¡¨æƒ…
                setTimeout(() => {
                    if (emoji.parentNode) {
                        emoji.parentNode.removeChild(emoji);
                    }
                }, 5000);
            };
            
            // å¼€å§‹è¡¨æƒ…é›¨
            const rainInterval = setInterval(createEmoji, emojiInterval);
            
            // åœæ­¢è¡¨æƒ…é›¨
            setTimeout(() => {
                clearInterval(rainInterval);
                // æ¸…ç†å‰©ä½™è¡¨æƒ…
                setTimeout(() => {
                    if (emojiRain.parentNode) {
                        emojiRain.parentNode.removeChild(emojiRain);
                    }
                }, 5000);
            }, rainDuration);
            
            // æ’­æ”¾éŸ³æ•ˆï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT');
                audio.volume = 0.3;
                audio.play().catch(() => {});
            } catch (e) {
                // å¿½ç•¥éŸ³æ•ˆé”™è¯¯
            }
        }
        
        // è·å–å½“å‰ä½ç½®
        function getCurrentPosition() {
            return new Promise((resolve, reject) => {
                if (!navigator.geolocation) {
                    reject(new Error('æµè§ˆå™¨ä¸æ”¯æŒåœ°ç†ä½ç½®'));
                    return;
                }
                
                // å¦‚æœç”¨æˆ·å·²ç»æ‹’ç»è¿‡ä½ç½®æƒé™ï¼Œä½†åœ¨åˆ·æ–°æ“ä½œä¸­ï¼Œå…è®¸é‡æ–°è¯·æ±‚
                if (isLocationDenied && !window.isRefreshingWeather) {
                    reject(new Error('ç”¨æˆ·å·²æ‹’ç»ä½ç½®æƒé™ï¼Œè¯·æ‰‹åŠ¨åˆ·æ–°é¡µé¢é‡è¯•'));
                    return;
                }
                
                navigator.geolocation.getCurrentPosition(resolve, (error) => {
                    console.error('åœ°ç†ä½ç½®è·å–å¤±è´¥:', error);
                    
                    // æ ¹æ®é”™è¯¯ç±»å‹æä¾›ä¸åŒçš„é”™è¯¯ä¿¡æ¯
                    let errorMessage = 'è·å–ä½ç½®å¤±è´¥';
                    switch (error.code) {
                        case 1:
                            errorMessage = 'ç”¨æˆ·æ‹’ç»äº†ä½ç½®æƒé™ï¼Œè¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­å…è®¸ä½ç½®è®¿é—®';
                            // å¦‚æœæ˜¯åˆ·æ–°æ“ä½œï¼Œé‡ç½®æ‹’ç»çŠ¶æ€ï¼Œå…è®¸ä¸‹æ¬¡åˆ·æ–°æ—¶é‡æ–°è¯·æ±‚
                            if (window.isRefreshingWeather) {
                                isLocationDenied = false;
                                console.log('åˆ·æ–°æ“ä½œä¸­ï¼Œé‡ç½®ä½ç½®æ‹’ç»çŠ¶æ€ï¼Œå…è®¸ä¸‹æ¬¡åˆ·æ–°é‡æ–°è¯·æ±‚');
                            } else {
                                isLocationDenied = true; // è®°ä½ç”¨æˆ·æ‹’ç»è¿‡
                            }
                            break;
                        case 2:
                            errorMessage = 'ä½ç½®ä¿¡æ¯ä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥';
                            break;
                        case 3:
                            errorMessage = 'è·å–ä½ç½®è¶…æ—¶ï¼Œè¯·é‡è¯•';
                            break;
                        default:
                            errorMessage = 'è·å–ä½ç½®å¤±è´¥ï¼Œè¯·é‡è¯•';
                    }
                    
                    reject(new Error(errorMessage));
                }, {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 600000
                });
            });
        }
        
        // è·å–å¤©æ°”æ•°æ®
        async function fetchWeatherData(lat, lon) {
            // ä½¿ç”¨æ–°çš„APIé…ç½®
            const API_KEY = '4a776958b592492fb125f95693c7c951';
            const API_HOST = 'nu4wctjgeg.re.qweatherapi.com';
            const location = `${lon},${lat}`;
            const url = `https://${API_HOST}/v7/weather/now?location=${location}`;
            
            try {
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'X-QW-Api-Key': API_KEY,
                        'Accept': 'application/json',
                        'Accept-Encoding': 'gzip'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`å¤©æ°”APIè¯·æ±‚å¤±è´¥: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('å¤©æ°”APIå“åº”:', data);
                return data;
            } catch (error) {
                console.error('å¤©æ°”APIè°ƒç”¨å¤±è´¥:', error);
                throw new Error('å¤©æ°”æ•°æ®è·å–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
            }
        }
        
        // è·å–åŸå¸‚åç§°ï¼ˆå¤šAPIå¤‡ç”¨ï¼‰
        async function getCityName(lat, lon) {
            try {
                console.log('æ­£åœ¨é€šè¿‡APIè·å–åŸå¸‚åç§°ï¼Œåæ ‡:', lat, lon);
                
                // å°è¯•å¤šä¸ªAPIæº
                const apis = [
                    // ä¸»APIï¼šBigDataCloud
                    `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=zh`,
                    // å¤‡ç”¨APIï¼šNominatim (OpenStreetMap)
                    `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=zh-CN,zh;q=0.9`,
                    // å¤‡ç”¨APIï¼šLocationIQ (éœ€è¦API keyï¼Œè¿™é‡Œä½œä¸ºç¤ºä¾‹)
                    // `https://us1.locationiq.com/v1/reverse.php?key=YOUR_API_KEY&lat=${lat}&lon=${lon}&format=json&accept-language=zh-CN`
                ];
                
                for (let i = 0; i < apis.length; i++) {
                    try {
                        console.log(`å°è¯•API ${i + 1}:`, apis[i]);
                        
                        // æ·»åŠ è¶…æ—¶æœºåˆ¶
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), 5000); // 5ç§’è¶…æ—¶
                        
                        const response = await fetch(apis[i], {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json',
                                'User-Agent': 'WeatherApp/1.0'
                            },
                            signal: controller.signal
                        });
                        
                        clearTimeout(timeoutId);
                        
                        if (!response.ok) {
                            console.log(`API ${i + 1} è¯·æ±‚å¤±è´¥:`, response.status);
                            continue;
                        }
                        
                        const data = await response.json();
                        console.log(`API ${i + 1} å“åº”:`, data);
                        
                        // è§£æä¸åŒAPIçš„å“åº”æ ¼å¼
                        let cityName = null;
                        
                        if (i === 0) {
                            // BigDataCloud API
                            cityName = data.city || data.locality || data.principalSubdivision;
                        } else if (i === 1) {
                            // Nominatim API
                            const address = data.address;
                            cityName = address.city || address.town || address.village || address.county || address.state;
                        }
                        
                        if (cityName) {
                            console.log(`API ${i + 1} è·å–åˆ°åŸå¸‚åç§°:`, cityName);
                            return cityName;
                        }
                        
                        console.log(`API ${i + 1} æœªè¿”å›åŸå¸‚åç§°`);
                        
                    } catch (apiError) {
                        console.error(`API ${i + 1} è°ƒç”¨å¤±è´¥:`, apiError);
                        continue;
                    }
                }
                
                console.log('æ‰€æœ‰APIéƒ½å¤±è´¥äº†');
                return null;
                
            } catch (error) {
                console.error('è·å–åŸå¸‚åç§°å®Œå…¨å¤±è´¥:', error);
                return null;
            }
        }
        
        // æ ¹æ®åæ ‡ä¼°ç®—åŸå¸‚åç§°
        function estimateCityFromCoordinates(lat, lon) {
            // ä¸­å›½ä¸»è¦åŸå¸‚çš„åæ ‡èŒƒå›´
            const cities = [
                { name: 'åŒ—äº¬', lat: 39.9042, lon: 116.4074, range: 0.5 },
                { name: 'ä¸Šæµ·', lat: 31.2304, lon: 121.4737, range: 0.5 },
                { name: 'å¹¿å·', lat: 23.1291, lon: 113.2644, range: 0.5 },
                { name: 'æ·±åœ³', lat: 22.3193, lon: 114.1694, range: 0.5 },
                { name: 'æ­å·', lat: 30.2741, lon: 120.1551, range: 0.5 },
                { name: 'å—äº¬', lat: 32.0603, lon: 118.7969, range: 0.5 },
                { name: 'æ­¦æ±‰', lat: 30.5928, lon: 114.3055, range: 0.5 },
                { name: 'æˆéƒ½', lat: 30.5728, lon: 104.0668, range: 0.5 },
                { name: 'è¥¿å®‰', lat: 34.3416, lon: 108.9398, range: 0.5 },
                { name: 'é‡åº†', lat: 29.4316, lon: 106.9123, range: 0.5 }
            ];
            
            for (const city of cities) {
                const distance = Math.sqrt(
                    Math.pow(lat - city.lat, 2) + Math.pow(lon - city.lon, 2)
                );
                
                if (distance <= city.range) {
                    return city.name;
                }
            }
            
            return null;
        }
        
        // æ›´æ–°å¤©æ°”æ˜¾ç¤º
        async function updateWeatherDisplay(data) {
            const weatherWidget = document.getElementById('weatherWidget');
            
            console.log('å¤©æ°”æ•°æ®:', data);
            
            if (data.code === '200' && data.now) {
                const weather = data.now;
                
                // è·å–åŸå¸‚åç§°
                let cityName = '';
                if (cachedLocation) {
                    try {
                        console.log('å¼€å§‹è·å–åŸå¸‚åç§°ï¼Œåæ ‡:', cachedLocation.latitude, cachedLocation.longitude);
                        // ç›´æ¥ä½¿ç”¨APIè·å–åŸå¸‚åç§°
                        cityName = await getCityName(cachedLocation.latitude, cachedLocation.longitude);
                        console.log('APIè·å–åŸå¸‚åç§°ç»“æœ:', cityName);
                    } catch (error) {
                        console.error('APIè·å–åŸå¸‚åç§°å¤±è´¥:', error);
                        cityName = null;
                    }
                } else {
                    console.log('æ²¡æœ‰ç¼“å­˜ä½ç½®ä¿¡æ¯ï¼Œæ— æ³•è·å–åŸå¸‚åç§°');
                }
                
                weatherWidget.innerHTML = `
                    <div class="weather-location">ğŸ“ å½“å‰ä½ç½®</div>
                    <div class="weather-temp">${weather.temp}Â°C</div>
                    <div class="weather-desc">${weather.text}</div>
                    <div class="weather-details">
                        <div class="weather-detail">
                            <span>æ¹¿åº¦</span>
                            <span>${weather.humidity}%</span>
                        </div>
                        <div class="weather-detail">
                            <span>é£é€Ÿ</span>
                            <span>${weather.windSpeed}km/h</span>
                        </div>
                    </div>
                    ${cityName ? `<div class="weather-city">${cityName}</div>` : ''}
                    <div class="weather-refresh-tip" style="font-size: 0.7em; opacity: 0.7; margin-top: 5px;">ç‚¹å‡»åˆ·æ–°ä½ç½®</div>
                `;
            } else if (data.code === '200' && data.now === undefined) {
                // å¦‚æœAPIè¿”å›æˆåŠŸä½†æ²¡æœ‰nowå­—æ®µï¼Œå°è¯•å…¶ä»–å­—æ®µ
                weatherWidget.innerHTML = `
                    <div class="weather-location">ğŸ“ å½“å‰ä½ç½®</div>
                    <div class="weather-temp">--Â°C</div>
                    <div class="weather-desc">å¤©æ°”æ•°æ®è§£æä¸­</div>
                    <div class="weather-details">
                        <div class="weather-detail">
                            <span>APIçŠ¶æ€</span>
                            <span>${data.code}</span>
                        </div>
                    </div>
                    <div class="weather-refresh-tip" style="font-size: 0.7em; opacity: 0.7; margin-top: 5px;">ç‚¹å‡»åˆ·æ–°ä½ç½®</div>
                `;
            } else {
                weatherWidget.innerHTML = `
                    <div class="weather-error">
                        <div>ğŸŒ¤ï¸ å¤©æ°”ä¿¡æ¯</div>
                        <div style="font-size: 0.8em; margin-top: 5px;">æ•°æ®è·å–å¤±è´¥ (${data.code || 'æœªçŸ¥é”™è¯¯'})</div>
                        <div class="weather-refresh-tip" style="font-size: 0.7em; opacity: 0.7; margin-top: 5px;">ç‚¹å‡»åˆ·æ–°ä½ç½®</div>
                    </div>
                `;
            }
        }
    </script>
</body>
</html> 
